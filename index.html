<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>äºŒä½æ•¸ä¹˜æ³•ç·´ç¿’ (ç´”æ·¨ä¹å®®æ ¼ç‰ˆ)</title>
    <style>
        @page { size: A4; margin: 0; }
        body { font-family: "Microsoft JhengHei", sans-serif; margin: 0; padding: 0; background: #f0f0f0; }
        
        .no-print { 
            text-align: center; padding: 15px; background: #2c3e50; 
            position: sticky; top: 0; z-index: 100; display: flex; justify-content: center; flex-wrap: wrap; gap: 10px;
        }
        button { padding: 8px 18px; font-size: 14px; cursor: pointer; color: white; border: none; border-radius: 4px; transition: 0.2s; }
        .btn-none { background: #27ae60; } .btn-unit { background: #2980b9; } 
        .btn-tens { background: #8e44ad; } .btn-rand { background: #c0392b; }
        button:hover { opacity: 0.9; transform: scale(1.05); }

        .a4-page {
            width: 210mm; height: 297mm; padding: 15mm 12mm; margin: 10mm auto;
            background: white; box-sizing: border-box; box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .header { text-align: center; margin-bottom: 5px; }
        .header h1 { margin: 5px 0; font-size: 22pt; letter-spacing: 3px; }
        
        .student-info { display: flex; justify-content: center; margin-bottom: 25px; font-size: 13pt; gap: 30px; }
        .student-info .line { border-bottom: 1.5px solid #000; padding: 0 15px; min-width: 60px; display: inline-block; text-align: center; }

        .quiz-container {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px 10px; height: 235mm;
        }

        .math-problem {
            border: 1px solid #eee; padding: 10px 5px; display: flex; flex-direction: column; align-items: center;
        }

        /* é¡Œç›®å€åŸŸå°é½Šä½ˆå±€ */
        .problem-top {
            display: grid;
            grid-template-columns: 35px 45px 45px 45px; /* å°é½Šä¸‹æ–¹çš„ç©ºç™½èˆ‡ç™¾ã€åã€å€‹ä½ */
            font-size: 28pt;
            font-weight: bold;
            text-align: center;
            line-height: 1.2;
        }

        .top-cell { width: 45px; height: 50px; display: flex; justify-content: center; align-items: center; }
        .top-sign { width: 35px; height: 50px; display: flex; justify-content: center; align-items: center; font-size: 22pt; }
        .underline { grid-column: 1 / 5; border-bottom: 3px solid black; margin: 2px 0 8px 0; }

        /* ç´”æ•¸å­—ä¹å®®æ ¼å€åŸŸ */
        .answer-grid {
            display: grid;
            grid-template-columns: repeat(3, 45px); /* åƒ…ç™¾ã€åã€å€‹ä½ */
            border-top: 2px solid #000;
            border-left: 2px solid #000;
        }

        .grid-cell {
            width: 45px; height: 50px;
            border-right: 1.5px solid #000;
            border-bottom: 1.5px solid #000;
            display: flex; justify-content: center; align-items: center;
        }

        .dashed-cell { background-image: radial-gradient(#aaa 1.2px, transparent 1.2px); background-size: 8px 8px; }
        .thick-bottom { border-bottom: 4px solid #000 !important; }

        .hint-col {
            display: flex; flex-direction: column; justify-content: space-around;
            height: 100%; font-size: 8.5pt; color: #666; padding-left: 8px; line-height: 50px; font-weight: bold;
        }

        .flex-row { display: flex; align-items: flex-start; padding-left: 35px; /* é€™è£¡é ç•™å‡ºå·¦å´ä¹˜è™Ÿä¸‹æ–¹çš„ç©ºç™½å¸¶ */ }
        .overall-layout { display: flex; flex-direction: column; align-items: flex-start; }

        @media print {
            body { background: none; }
            .no-print { display: none; }
            .a4-page { margin: 0; box-shadow: none; border: none; }
        }
    </style>
</head>
<body>

<div class="no-print">
    <button class="btn-none" onclick="generateProblems('none')">ğŸŸ¢ ä¸é€²ä½</button>
    <button class="btn-unit" onclick="generateProblems('unit')">ğŸ”µ å€‹ä½é€²åä½</button>
    <button class="btn-tens" onclick="generateProblems('tens')">ğŸŸ£ åä½é€²ç™¾ä½</button>
    <button class="btn-rand" onclick="generateProblems('any')">ğŸ”´ éš¨æ©Ÿæ··åˆ</button>
</div>

<div class="a4-page">
    <div class="header">
        <h1 id="pageTitle">äºŒä½æ•¸ä¹˜æ³•ç·´ç¿’ (æ‹†è§£ä¹å®®æ ¼)</h1>
    </div>

    <div class="student-info">
        <div>ç­ç´šï¼š<span class="line"></span></div>
        <div>åº§è™Ÿï¼š<span class="line"></span></div>
        <div>å§“åï¼š<span class="line"></span></div>
    </div>

    <div id="quizContainer" class="quiz-container"></div>
</div>

<script>
    function generateProblems(mode) {
        const container = document.getElementById('quizContainer');
        const title = document.getElementById('pageTitle');
        container.innerHTML = ''; 
        
        let modeName = (mode==='none')?"ä¸é€²ä½":(mode==='unit')?"å€‹ä½é€²åä½":(mode==='tens')?"åä½é€²ç™¾ä½":"æ··åˆé€²ä½";
        title.innerText = `äºŒä½æ•¸ä¹˜æ³•ç·´ç¿’ (${modeName})`;

        for (let i = 0; i < 9; i++) {
            let num1, num2, match;
            do {
                num1 = Math.floor(Math.random() * 89) + 11;
                num2 = Math.floor(Math.random() * 8) + 2;
                let n1_10 = Math.floor(num1 / 10), n1_1 = num1 % 10;
                let isUnitCarry = (n1_1 * num2) >= 10, isTensCarry = (n1_10 * num2) >= 10;
                if (mode === 'none') match = !isUnitCarry && !isTensCarry;
                else if (mode === 'unit') match = isUnitCarry && !isTensCarry;
                else if (mode === 'tens') match = !isUnitCarry && isTensCarry;
                else match = isUnitCarry || isTensCarry;
            } while (!match);

            let n1_10 = Math.floor(num1 / 10), n1_1 = num1 % 10;

            container.innerHTML += `
            <div class="math-problem">
                <div class="overall-layout">
                    <div class="problem-top">
                        <div class="top-sign"></div><div class="top-cell"></div><div class="top-cell">${n1_10}</div><div class="top-cell">${n1_1}</div>
                        <div class="top-sign">Ã—</div><div class="top-cell"></div><div class="top-cell"></div><div class="top-cell">${num2}</div>
                        <div class="underline"></div>
                    </div>
                    
                    <div class="flex-row">
                        <div class="answer-grid">
                            <div class="grid-cell dashed-cell"></div><div class="grid-cell dashed-cell"></div><div class="grid-cell dashed-cell"></div>
                            <div class="grid-cell dashed-cell thick-bottom"></div><div class="grid-cell dashed-cell thick-bottom"></div><div class="grid-cell dashed-cell thick-bottom"></div>
                            <div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div>
                        </div>
                        
                        <div class="hint-col">
                            <div>â†(${n1_1}Ã—${num2})</div>
                            <div>â†(${n1_10}0Ã—${num2})</div>
                            <div>â†(ç¸½å’Œ)</div>
                        </div>
                    </div>
                </div>
            </div>`;
        }
    }
    window.onload = () => generateProblems('none');
</script>

</body>
</html>
